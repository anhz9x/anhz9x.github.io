import{r as m,j as e}from"./react-CeYxiRmC.js";import{u as $}from"./react-router-dom-o4KdQ8dK.js";import{u as v}from"./useDebounce-BApLLqdd.js";import{h as y}from"./index-ug2vDTIo.js";import{m as p,c as z}from"./notify-DA3BzPi_.js";import{F as o,C as K,b as R,c as I,T as L,B as g,I as u,e as q,i as A}from"./antd-CWlyDj0S.js";import{a6 as G,ae as H,aa as J,a9 as N}from"./@ant-design-NQwz6VZX.js";import"./classnames-BK5ccKcQ.js";import"./react-dom-Bwn-WS6j.js";import"./scheduler-CzFDRTuY.js";import"./react-router-BQwVR8Zd.js";import"./@remix-run-3jUiC8cZ.js";import"./@casl-D9HI8Hol.js";import"./@ucast-C1jhqbEt.js";import"./@reduxjs-Dg9g6cAv.js";import"./redux-DITMfSWq.js";import"./immer-DqxjFn0G.js";import"./redux-thunk-ClJT1hhx.js";import"./axios-9PTFF6AP.js";import"./react-redux-BgQWloB6.js";import"./use-sync-external-store-Co5PKEhT.js";import"./rc-util-DVEPga9-.js";import"./@babel-Bssi87AP.js";import"./@emotion-CW87jbl0.js";import"./stylis-D5iaQeiq.js";import"./resize-observer-polyfill-B1PUzC5B.js";import"./rc-resize-observer-OqVzQPEu.js";import"./rc-motion-C3tnhy2U.js";import"./@rc-component-B7glsBvU.js";import"./rc-notification-BU1JQ1oB.js";import"./rc-overflow-BHdZLj7t.js";import"./rc-picker-UBE7xiBA.js";import"./dayjs-Cjk_ngT2.js";import"./rc-tabs-CxzWAOyN.js";import"./rc-dropdown-BO-tmEXF.js";import"./rc-menu-CN7ruIKX.js";import"./rc-select-C2-AJ45Z.js";import"./rc-virtual-list-2uybl3mp.js";import"./rc-field-form-RBvcZ110.js";import"./scroll-into-view-if-needed-DRvhZyyj.js";import"./compute-scroll-into-view-J484ERGr.js";import"./rc-dialog-DjLbSgI8.js";import"./rc-switch-gTEUW9ud.js";import"./rc-table-mlfxtKPe.js";import"./rc-tree-XLUh9fGJ.js";import"./rc-checkbox-DSSeAk8Y.js";import"./rc-pagination-BIRv3rAM.js";import"./throttle-debounce-CUWDS_la.js";import"./rc-input-BMc9GUi3.js";import"./rc-tooltip-Cl3xOnqL.js";import"./rc-textarea-GKK6NUoL.js";import"./copy-to-clipboard-iuHVwNMD.js";import"./toggle-selection-BHUZwh74.js";const b=i=>({keyword:i.keyword||null,page:i.page||1,per_page:i.per_page||10}),Ne=()=>{const[i]=o.useForm(),[d,E]=$(),[n,C]=m.useState(()=>({keyword:d.get("keyword")||null,page:parseInt(d.get("page")||"1",10),per_page:parseInt(d.get("per_page")||"10",10)})),k=v(n,500),[w,c]=m.useState(!1),[S,M]=m.useState({meta:{total:0,page:1,per_page:10},data:[]}),[_,x]=m.useState(!1),[h,f]=m.useState(null);m.useEffect(()=>{const s={...n};Object.entries(s).forEach(([a,r])=>{r===null||r===""?d.delete(a):d.set(a,String(r))}),E(d)},[n]),m.useEffect(()=>{j(b(k))},[k]);const j=async s=>{var a,r;c(!0);try{const t=await y.gets(s);M(t.data)}catch(t){p((a=t==null?void 0:t.meta)==null?void 0:a.message,(r=t==null?void 0:t.meta)==null?void 0:r.code)}finally{c(!1)}},T=async s=>{var a,r;try{if(c(!0),h){const t=await y.update(h.id,s),{meta:l}=t.data;p(l.message,l.code)}else{const t=await y.create(s),{meta:l}=t.data;p(l.message,l.code)}x(!1),i.resetFields(),await j(b(n))}catch(t){p((a=t==null?void 0:t.meta)==null?void 0:a.message,(r=t==null?void 0:t.meta)==null?void 0:r.code)}finally{c(!1)}},O=async s=>{var a,r;try{if(!await z())return;c(!0);const l=await y.destroy(s),{meta:D}=l.data;p(D.message,D.code),await j(b(n))}catch(t){p((a=t==null?void 0:t.meta)==null?void 0:a.message,(r=t==null?void 0:t.meta)==null?void 0:r.code)}finally{c(!1)}},P=(s,a)=>{a===void 0&&(a=null),C(r=>({...r,[s]:a,page:1}))},B=s=>{f(s),i.setFieldsValue(s),x(!0)},V=()=>{f(null),i.resetFields(),x(!0)},F=()=>{x(!1),f(null),i.resetFields()},U=[{title:"ID",dataIndex:"id",key:"id"},{title:"Brand",dataIndex:"brand",key:"brand"},{title:"Model",dataIndex:"model",key:"model"},{title:"Color",dataIndex:"color",key:"color"},{title:"Description",dataIndex:"description",key:"description"},{title:"Registration",dataIndex:"registration",key:"registration"},{title:"Actions",key:"actions",align:"center",width:120,render:(s,a)=>e.jsxs("div",{children:[e.jsx(g,{type:"link",icon:e.jsx(J,{}),onClick:()=>B(a)}),e.jsx(g,{type:"link",danger:!0,icon:e.jsx(N,{}),onClick:()=>O(a.id)})]})}];return e.jsxs(K,{children:[e.jsxs(R,{children:[e.jsx(I,{span:12,children:e.jsx(L.Title,{level:4,children:"Vehicles"})}),e.jsx(I,{span:2,offset:10,style:{marginTop:30},children:e.jsx(g,{type:"primary",icon:e.jsx(G,{}),onClick:V,block:!0,children:"Create"})})]}),e.jsx(o,{layout:"vertical",children:e.jsx(R,{gutter:[16,0],children:e.jsx(I,{xs:24,sm:12,md:6,lg:4,children:e.jsx(o.Item,{label:"Keyword",children:e.jsx(u,{placeholder:"Search by ID, brand, model",value:n.keyword||"",onChange:s=>P("keyword",s.target.value),allowClear:!0,prefix:e.jsx(H,{})})})})})}),e.jsx(q,{size:"small",columns:U,dataSource:S.data,rowKey:"id",loading:w,pagination:{current:n.page,pageSize:n.per_page,total:S.meta.total,onChange:(s,a)=>C(r=>({...r,page:s,per_page:a}))}}),e.jsx(A,{title:h?"Update Vehicle":"Create Vehicle",open:_,onCancel:F,footer:null,children:e.jsxs(o,{form:i,layout:"vertical",onFinish:T,children:[e.jsx(o.Item,{rules:[{required:!0,message:"Please input brand"}],name:"brand",label:"Brand",children:e.jsx(u,{})}),e.jsx(o.Item,{name:"model",label:"Model",children:e.jsx(u,{})}),e.jsx(o.Item,{name:"color",label:"Color",children:e.jsx(u,{})}),e.jsx(o.Item,{name:"description",label:"Description",children:e.jsx(u,{})}),e.jsx(o.Item,{name:"registration",label:"Registration",children:e.jsx(u,{})}),e.jsxs(o.Item,{children:[e.jsx(g,{type:"primary",htmlType:"submit",loading:w,children:h?"Update":"Create"}),e.jsx(g,{onClick:F,style:{marginLeft:8},children:"Cancel"})]})]})})]})};export{Ne as default};
