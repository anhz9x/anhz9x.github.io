import{r as n,j as t}from"./react-CeYxiRmC.js";import{u as z}from"./react-router-dom-o4KdQ8dK.js";import{u as K}from"./useDebounce-BApLLqdd.js";import{r as h}from"./index-CBKo7eUj.js";import{m as p,c as L}from"./notify-DFuPAhq-.js";import{a as q}from"./react-router-BQwVR8Zd.js";import{F as x,C as A,b as R,c as w,T as _,B as c,I as D,e as V,i as G}from"./antd-CWlyDj0S.js";import{a6 as H,a3 as J,aa as Q,a9 as W}from"./@ant-design-NQwz6VZX.js";import"./classnames-BK5ccKcQ.js";import"./react-dom-Bwn-WS6j.js";import"./scheduler-CzFDRTuY.js";import"./@remix-run-3jUiC8cZ.js";import"./@casl-D9HI8Hol.js";import"./@ucast-C1jhqbEt.js";import"./@reduxjs-Dg9g6cAv.js";import"./redux-DITMfSWq.js";import"./immer-DqxjFn0G.js";import"./redux-thunk-ClJT1hhx.js";import"./axios-9PTFF6AP.js";import"./react-redux-BgQWloB6.js";import"./use-sync-external-store-Co5PKEhT.js";import"./rc-util-DVEPga9-.js";import"./@babel-Bssi87AP.js";import"./@emotion-CW87jbl0.js";import"./stylis-D5iaQeiq.js";import"./resize-observer-polyfill-B1PUzC5B.js";import"./rc-resize-observer-OqVzQPEu.js";import"./rc-motion-C3tnhy2U.js";import"./@rc-component-B7glsBvU.js";import"./rc-notification-BU1JQ1oB.js";import"./rc-overflow-BHdZLj7t.js";import"./rc-picker-UBE7xiBA.js";import"./dayjs-Cjk_ngT2.js";import"./rc-tabs-CxzWAOyN.js";import"./rc-dropdown-BO-tmEXF.js";import"./rc-menu-CN7ruIKX.js";import"./rc-select-C2-AJ45Z.js";import"./rc-virtual-list-2uybl3mp.js";import"./rc-field-form-RBvcZ110.js";import"./scroll-into-view-if-needed-DRvhZyyj.js";import"./compute-scroll-into-view-J484ERGr.js";import"./rc-dialog-DjLbSgI8.js";import"./rc-switch-gTEUW9ud.js";import"./rc-table-mlfxtKPe.js";import"./rc-tree-XLUh9fGJ.js";import"./rc-checkbox-DSSeAk8Y.js";import"./rc-pagination-BIRv3rAM.js";import"./throttle-debounce-CUWDS_la.js";import"./rc-input-BMc9GUi3.js";import"./rc-tooltip-Cl3xOnqL.js";import"./rc-textarea-GKK6NUoL.js";import"./copy-to-clipboard-iuHVwNMD.js";import"./toggle-selection-BHUZwh74.js";const C=d=>({keyword:d.keyword||null,page:d.page||1,per_page:d.per_page||10}),We=()=>{const d=q(),[u]=x.useForm(),[l,T]=z(),[r,k]=n.useState(()=>({keyword:l.get("keyword")||null,page:parseInt(l.get("page")||"1",10),per_page:parseInt(l.get("per_page")||"10",10)})),I=K(r,500),[F,m]=n.useState(!1),[S,v]=n.useState({meta:{total:0,page:1,per_page:10},data:[]}),[M,g]=n.useState(!1),[f,y]=n.useState(null);n.useEffect(()=>{const s={...r};Object.entries(s).forEach(([a,o])=>{o===null||o===""?l.delete(a):l.set(a,String(o))}),T(l)},[r]),n.useEffect(()=>{j(C(I))},[I]);const j=async s=>{var a,o;m(!0);try{const e=await h.gets(s);v(e.data)}catch(e){p((a=e==null?void 0:e.meta)==null?void 0:a.message,(o=e==null?void 0:e.meta)==null?void 0:o.code)}finally{m(!1)}},O=async s=>{var a,o;try{if(m(!0),f){const e=await h.update(f.id,s),{meta:i}=e.data;p(i.message,i.code)}else{const e=await h.create(s),{meta:i}=e.data;p(i.message,i.code)}g(!1),u.resetFields(),await j(C(r))}catch(e){p((a=e==null?void 0:e.meta)==null?void 0:a.message,(o=e==null?void 0:e.meta)==null?void 0:o.code)}finally{m(!1)}},P=async s=>{var a,o;try{if(!await L())return;m(!0);const i=await h.destroy(s),{meta:E}=i.data;p(E.message,E.code),await j(C(r))}catch(e){p((a=e==null?void 0:e.meta)==null?void 0:a.message,(o=e==null?void 0:e.meta)==null?void 0:o.code)}finally{m(!1)}},B=(s,a)=>{a===void 0&&(a=null),k(o=>({...o,[s]:a,page:1}))},N=s=>{y(s),u.setFieldsValue(s),g(!0)},$=()=>{y(null),u.resetFields(),g(!0)},b=()=>{g(!1),y(null),u.resetFields()},U=[{title:"ID",dataIndex:"id",key:"id"},{title:"Name",dataIndex:"name",key:"name"},{title:"Actions",key:"actions",align:"center",width:120,render:(s,a)=>t.jsxs("div",{children:[t.jsx(c,{type:"link",icon:t.jsx(J,{}),onClick:()=>d(`/roles/${a.id}/permissions`)}),t.jsx(c,{type:"link",icon:t.jsx(Q,{}),onClick:()=>N(a)}),t.jsx(c,{type:"link",danger:!0,icon:t.jsx(W,{}),onClick:()=>P(a.id)})]})}];return t.jsxs(A,{children:[t.jsxs(R,{children:[t.jsx(w,{span:12,children:t.jsx(_.Title,{level:4,children:"Roles"})}),t.jsx(w,{span:2,offset:10,style:{marginBottom:16},children:t.jsx(c,{type:"primary",icon:t.jsx(H,{}),onClick:$,block:!0,children:"Create"})})]}),t.jsx(R,{gutter:[16,16],style:{marginBottom:16},children:t.jsxs(w,{xs:24,sm:12,md:3,children:[t.jsx(_.Title,{level:5,children:"Keyword"}),t.jsx(D,{placeholder:"ID, Name",value:r.keyword||"",onChange:s=>B("keyword",s.target.value),allowClear:!0})]})}),t.jsx(V,{size:"small",columns:U,dataSource:S.data,rowKey:"id",loading:F,pagination:{current:r.page,pageSize:r.per_page,total:S.meta.total,onChange:(s,a)=>k(o=>({...o,page:s,per_page:a}))}}),t.jsx(G,{title:f?"Update":"Create",open:M,onCancel:b,footer:null,children:t.jsxs(x,{form:u,layout:"vertical",onFinish:O,children:[t.jsx(x.Item,{name:"name",label:"Name",rules:[{required:!0,message:"Please enter name"}],children:t.jsx(D,{})}),t.jsxs(x.Item,{children:[t.jsx(c,{type:"primary",htmlType:"submit",loading:F,children:f?"Update":"Create"}),t.jsx(c,{onClick:b,style:{marginLeft:8},children:"Cancel"})]})]})})]})};export{We as default};
