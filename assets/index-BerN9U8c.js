import{r as m,j as e}from"./react-CeYxiRmC.js";import{u as N}from"./react-router-dom-o4KdQ8dK.js";import{u as q}from"./useDebounce-BApLLqdd.js";import{m as f}from"./index-ug2vDTIo.js";import{m as p,c as U}from"./notify-DA3BzPi_.js";import{F as o,C as $,b as E,c as b,T as z,B as u,I as g,e as H,i as K,d as F}from"./antd-CWlyDj0S.js";import{a6 as W,ae as G,aa as J,a9 as Q}from"./@ant-design-NQwz6VZX.js";import"./classnames-BK5ccKcQ.js";import"./react-dom-Bwn-WS6j.js";import"./scheduler-CzFDRTuY.js";import"./react-router-BQwVR8Zd.js";import"./@remix-run-3jUiC8cZ.js";import"./@casl-D9HI8Hol.js";import"./@ucast-C1jhqbEt.js";import"./@reduxjs-Dg9g6cAv.js";import"./redux-DITMfSWq.js";import"./immer-DqxjFn0G.js";import"./redux-thunk-ClJT1hhx.js";import"./axios-9PTFF6AP.js";import"./react-redux-BgQWloB6.js";import"./use-sync-external-store-Co5PKEhT.js";import"./rc-util-DVEPga9-.js";import"./@babel-Bssi87AP.js";import"./@emotion-CW87jbl0.js";import"./stylis-D5iaQeiq.js";import"./resize-observer-polyfill-B1PUzC5B.js";import"./rc-resize-observer-OqVzQPEu.js";import"./rc-motion-C3tnhy2U.js";import"./@rc-component-B7glsBvU.js";import"./rc-notification-BU1JQ1oB.js";import"./rc-overflow-BHdZLj7t.js";import"./rc-picker-UBE7xiBA.js";import"./dayjs-Cjk_ngT2.js";import"./rc-tabs-CxzWAOyN.js";import"./rc-dropdown-BO-tmEXF.js";import"./rc-menu-CN7ruIKX.js";import"./rc-select-C2-AJ45Z.js";import"./rc-virtual-list-2uybl3mp.js";import"./rc-field-form-RBvcZ110.js";import"./scroll-into-view-if-needed-DRvhZyyj.js";import"./compute-scroll-into-view-J484ERGr.js";import"./rc-dialog-DjLbSgI8.js";import"./rc-switch-gTEUW9ud.js";import"./rc-table-mlfxtKPe.js";import"./rc-tree-XLUh9fGJ.js";import"./rc-checkbox-DSSeAk8Y.js";import"./rc-pagination-BIRv3rAM.js";import"./throttle-debounce-CUWDS_la.js";import"./rc-input-BMc9GUi3.js";import"./rc-tooltip-Cl3xOnqL.js";import"./rc-textarea-GKK6NUoL.js";import"./copy-to-clipboard-iuHVwNMD.js";import"./toggle-selection-BHUZwh74.js";const I=n=>({keyword:n.keyword||null,page:n.page||1,per_page:n.per_page||10}),O=[{label:"VOICE",value:"VOICE"},{label:"SMS",value:"SMS"},{label:"VIBER",value:"VIBER"},{label:"WHATSAPP",value:"WHATSAPP"}],Qe=()=>{const[n]=o.useForm(),[c,L]=N(),[l,C]=m.useState(()=>({keyword:c.get("keyword")||null,page:parseInt(c.get("page")||"1",10),per_page:parseInt(c.get("per_page")||"10",10)})),w=q(l,500),[S,d]=m.useState(!1),[_,M]=m.useState({meta:{total:0,page:1,per_page:10},data:[]}),[R,h]=m.useState(!1),[x,j]=m.useState(null);m.useEffect(()=>{const r={...l};Object.entries(r).forEach(([t,s])=>{s===null||s===""?c.delete(t):c.set(t,String(s))}),L(c)},[l]),m.useEffect(()=>{y(I(w))},[w]);const y=async r=>{var t,s;d(!0);try{const a=await f.gets(r);M(a.data)}catch(a){p((t=a==null?void 0:a.meta)==null?void 0:t.message,(s=a==null?void 0:a.meta)==null?void 0:s.code)}finally{d(!1)}},T=async r=>{var t,s;try{if(d(!0),x){const a=await f.update(x.id,r),{meta:i}=a.data;p(i.message,i.code)}else{const a=await f.create(r),{meta:i}=a.data;p(i.message,i.code)}h(!1),n.resetFields(),await y(I(l))}catch(a){p((t=a==null?void 0:a.meta)==null?void 0:t.message,(s=a==null?void 0:a.meta)==null?void 0:s.code)}finally{d(!1)}},v=async r=>{var t,s;try{if(!await U())return;d(!0);const i=await f.destroy(r),{meta:P}=i.data;p(P.message,P.code),await y(I(l))}catch(a){p((t=a==null?void 0:a.meta)==null?void 0:t.message,(s=a==null?void 0:a.meta)==null?void 0:s.code)}finally{d(!1)}},D=(r,t)=>{t===void 0&&(t=null),C(s=>({...s,[r]:t,page:1}))},A=r=>{j(r),n.setFieldsValue(r),h(!0)},V=()=>{j(null),n.resetFields(),h(!0)},k=()=>{h(!1),j(null),n.resetFields()},B=[{title:"ID",dataIndex:"id",key:"id"},{title:"Name",dataIndex:"name",key:"name"},{title:"Phone Number",dataIndex:"phone_number",key:"phone_number"},{title:"Preferred contact method",dataIndex:"preferred_contact_method",key:"preferred_contact_method"},{title:"Contact methods",dataIndex:"contact_methods",key:"contact_methods",render:r=>e.jsx("span",{children:r.join(", ")})},{title:"License number",dataIndex:"license_number",key:"license_number"},{title:"Actions",key:"actions",align:"center",width:120,render:(r,t)=>e.jsxs("div",{children:[e.jsx(u,{type:"link",icon:e.jsx(J,{}),onClick:()=>A(t)}),e.jsx(u,{type:"link",danger:!0,icon:e.jsx(Q,{}),onClick:()=>v(t.id)})]})}];return e.jsxs($,{children:[e.jsxs(E,{children:[e.jsx(b,{span:12,children:e.jsx(z.Title,{level:4,children:"Drivers"})}),e.jsx(b,{span:2,offset:10,style:{marginTop:30},children:e.jsx(u,{type:"primary",icon:e.jsx(W,{}),onClick:V,block:!0,children:"Create"})})]}),e.jsx(o,{layout:"vertical",children:e.jsx(E,{gutter:[16,0],children:e.jsx(b,{xs:24,sm:12,md:6,lg:4,children:e.jsx(o.Item,{label:"Keyword",children:e.jsx(g,{placeholder:"Search by ID, Name, Phone",value:l.keyword||"",onChange:r=>D("keyword",r.target.value),allowClear:!0,prefix:e.jsx(G,{})})})})})}),e.jsx(H,{size:"small",columns:B,dataSource:_.data,rowKey:"id",loading:S,pagination:{current:l.page,pageSize:l.per_page,total:_.meta.total,onChange:(r,t)=>C(s=>({...s,page:r,per_page:t}))}}),e.jsx(K,{title:x?"Update":"Create",open:R,onCancel:k,footer:null,children:e.jsxs(o,{form:n,layout:"vertical",onFinish:T,children:[e.jsx(o.Item,{name:"name",label:"Name",rules:[{required:!0,message:"Please enter name"}],children:e.jsx(g,{})}),e.jsx(o.Item,{name:"phone_number",label:"Phone number",rules:[{required:!0,message:"Please enter phone number"}],children:e.jsx(g,{placeholder:"+441200008888"})}),e.jsx(o.Item,{name:"preferred_contact_method",label:"Preferred contact method",rules:[{required:!0,message:"Please enter preferred contact method"}],children:e.jsx(F,{placeholder:"Select preferred contact method",options:O,allowClear:!0,showSearch:!0,filterOption:(r,t)=>((t==null?void 0:t.label)??"").toLowerCase().includes(r.toLowerCase())})}),e.jsx(o.Item,{name:"contact_methods",label:"Contact methods",children:e.jsx(F,{placeholder:"Select contact methods",options:O,allowClear:!0,showSearch:!0,mode:"multiple",filterOption:(r,t)=>((t==null?void 0:t.label)??"").toLowerCase().includes(r.toLowerCase())})}),e.jsx(o.Item,{name:"license_number",label:"License number",children:e.jsx(g,{})}),e.jsxs(o.Item,{children:[e.jsx(u,{type:"primary",htmlType:"submit",loading:S,children:x?"Update":"Create"}),e.jsx(u,{onClick:k,style:{marginLeft:8},children:"Cancel"})]})]})})]})};export{Qe as default};
