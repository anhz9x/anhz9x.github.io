import{j as t,r as f}from"./react-CeYxiRmC.js";import{L as b}from"./react-router-dom-o4KdQ8dK.js";import{A as j}from"./auth-service-m5y2BoNV.js";import{u as k,c as C,e as I,a as R,b as S,s as L}from"./index-ug2vDTIo.js";import{m as K}from"./notify-DA3BzPi_.js";import{a as x,b as A,O as E}from"./react-router-BQwVR8Zd.js";import{Z as O,_ as $,$ as v,a0 as z,a1 as B,a2 as D,a3 as T,a4 as W,a5 as F}from"./@ant-design-NQwz6VZX.js";import{D as P,M as U,t as H,L as y,B as M}from"./antd-CWlyDj0S.js";import"./classnames-BK5ccKcQ.js";import"./react-dom-Bwn-WS6j.js";import"./scheduler-CzFDRTuY.js";import"./@remix-run-3jUiC8cZ.js";import"./axios-9PTFF6AP.js";import"./@casl-D9HI8Hol.js";import"./@ucast-C1jhqbEt.js";import"./@reduxjs-Dg9g6cAv.js";import"./redux-DITMfSWq.js";import"./immer-DqxjFn0G.js";import"./redux-thunk-ClJT1hhx.js";import"./react-redux-BgQWloB6.js";import"./use-sync-external-store-Co5PKEhT.js";import"./rc-util-DVEPga9-.js";import"./@babel-Bssi87AP.js";import"./@emotion-CW87jbl0.js";import"./stylis-D5iaQeiq.js";import"./resize-observer-polyfill-B1PUzC5B.js";import"./rc-resize-observer-OqVzQPEu.js";import"./rc-motion-C3tnhy2U.js";import"./@rc-component-B7glsBvU.js";import"./rc-notification-BU1JQ1oB.js";import"./rc-overflow-BHdZLj7t.js";import"./rc-picker-UBE7xiBA.js";import"./dayjs-Cjk_ngT2.js";import"./rc-tabs-CxzWAOyN.js";import"./rc-dropdown-BO-tmEXF.js";import"./rc-menu-CN7ruIKX.js";import"./rc-select-C2-AJ45Z.js";import"./rc-virtual-list-2uybl3mp.js";import"./rc-field-form-RBvcZ110.js";import"./scroll-into-view-if-needed-DRvhZyyj.js";import"./compute-scroll-into-view-J484ERGr.js";import"./rc-dialog-DjLbSgI8.js";import"./rc-switch-gTEUW9ud.js";import"./rc-table-mlfxtKPe.js";import"./rc-tree-XLUh9fGJ.js";import"./rc-checkbox-DSSeAk8Y.js";import"./rc-pagination-BIRv3rAM.js";import"./throttle-debounce-CUWDS_la.js";import"./rc-input-BMc9GUi3.js";import"./rc-tooltip-Cl3xOnqL.js";import"./rc-textarea-GKK6NUoL.js";import"./copy-to-clipboard-iuHVwNMD.js";import"./toggle-selection-BHUZwh74.js";const G=()=>{var n;const{state:s,dispatch:e}=k(),o=x(),i=[{key:"1",label:C(I((n=s.info)==null?void 0:n.email))},{type:"divider"},{key:"4",label:"Logout",icon:t.jsx(O,{}),extra:"⌘",onClick:async()=>{var a,c;try{await j.logout(),e({type:"LOGOUT"}),o("/login")}catch(r){K((a=r==null?void 0:r.meta)==null?void 0:a.message,(c=r==null?void 0:r.meta)==null?void 0:c.code)}}}];return t.jsx(t.Fragment,{children:t.jsx(P,{menu:{items:i},children:t.jsx("a",{onClick:a=>a.preventDefault(),children:t.jsx($,{style:{fontSize:"20px",fontWeight:"bold",marginRight:"16px"}})})})})};function m(s,e,o,i){return{key:e,icon:o,children:i,label:s}}const w=[m("Home","/",t.jsx(v,{})),m("Bookings","/bookings",t.jsx(z,{})),m("Drivers","/drivers",t.jsx(B,{})),m("Vehicles","/vehicles",t.jsx(D,{})),m("Settings","settings",t.jsx(T,{}),[m("Users","/users",void 0)])],u=s=>{for(const e of h)if("children"in e&&e.children&&e.children.some(o=>s.startsWith(o==null?void 0:o.key)))return e.key},g=s=>s.map(e=>{if("children"in e&&e.children){const o=g(e.children);return o.length>0?m(e.label,e.key,e.icon,o):null}else{const o=e.key;if(o==="/")return e;const n=o.split("/").filter(Boolean)[0];return S("index",n)?e:null}}).filter(Boolean);let h=g(w);R.on("updated",()=>{h=g(w)});const N=s=>{const e=[],o=i=>{i.forEach(n=>{"children"in n&&n.children?o(n.children):n!=null&&n.key&&e.push(n.key)})};return o(h),e.filter(i=>s.startsWith(i)).sort((i,n)=>n.length-i.length)[0]||"/"},V=()=>{const s=A(),e=x(),o=s.pathname,[i,n]=f.useState(o),[a,c]=f.useState(u(o));f.useEffect(()=>{n(o),c(u(o)),n(N(o))},[o]);const r=l=>{n(l.key);const d=u(l.key);c(d),e(l.key)};return t.jsx(U,{onClick:r,selectedKeys:[i],openKeys:a?[a]:[],onOpenChange:l=>c(l.at(-1)),theme:"dark",mode:"inline",items:h})},{Header:X,Content:Y,Footer:Z,Sider:_}=y,_e=()=>{const[s,e]=f.useState(window.innerWidth<768),{token:{colorBgContainer:o}}=H.useToken(),i=x(),{state:n,dispatch:a}=k();return f.useEffect(()=>{const c=async()=>{try{const d=await j.me(),{data:p}=d.data||d;p!=null&&p.info&&(p!=null&&p.rights)&&a({type:"UPDATE",payload:{info:p.info,rights:p.rights}})}catch{a({type:"LOGOUT"}),i("/login")}},r=n.token;r?(L(r),c()):i("/login");const l=()=>{e(window.innerWidth<768)};return window.addEventListener("resize",l),()=>window.removeEventListener("resize",l)},[]),t.jsxs(y,{style:{minHeight:"100vh"},children:[t.jsxs(_,{collapsible:!0,collapsed:s,onCollapse:c=>e(c),children:[t.jsx("div",{style:{fontSize:22,fontWeight:"bold",textAlign:"center",padding:"14px"},children:t.jsx(b,{to:"/",style:{color:"#154e84"},children:s?t.jsx(v,{}):"TAXIS"})}),t.jsx(V,{})]}),t.jsxs(y,{children:[t.jsxs(X,{style:{padding:0,background:o,display:"flex",justifyContent:"space-between"},children:[t.jsx(M,{type:"text",icon:s?t.jsx(W,{}):t.jsx(F,{}),onClick:()=>e(!s),style:{fontSize:"16px",width:64,height:64}}),t.jsx(G,{})]}),t.jsx(Y,{style:{margin:"16px"},children:t.jsx(E,{})}),t.jsxs(Z,{style:{textAlign:"center"},children:["Design ©",new Date().getFullYear()," Created by Terpise"]})]})]})};export{_e as default};
