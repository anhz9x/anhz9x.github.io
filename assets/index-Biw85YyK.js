import{r as n,j as t}from"./react-CeYxiRmC.js";import{u as A,a as B}from"./react-redux-BgQWloB6.js";import{u as F}from"./react-router-dom-o4KdQ8dK.js";import{f as $,b as N}from"./index-CBKo7eUj.js";import{F as O}from"./constants-C-fR6r-u.js";import{u as z}from"./useDebounce-BApLLqdd.js";import{u as I}from"./user-service-DX6EU1Ct.js";import{m as x,c as K}from"./notify-DFuPAhq-.js";import{a as L}from"./react-router-BQwVR8Zd.js";import{C as M,b as S,c as m,T as d,B as u,I as U,d as C,e as Q,f as Y}from"./antd-CWlyDj0S.js";import{a6 as q,a7 as G,a8 as H,a9 as J}from"./@ant-design-NQwz6VZX.js";import"./classnames-BK5ccKcQ.js";import"./use-sync-external-store-Co5PKEhT.js";import"./react-dom-Bwn-WS6j.js";import"./scheduler-CzFDRTuY.js";import"./@remix-run-3jUiC8cZ.js";import"./@casl-D9HI8Hol.js";import"./@ucast-C1jhqbEt.js";import"./@reduxjs-Dg9g6cAv.js";import"./redux-DITMfSWq.js";import"./immer-DqxjFn0G.js";import"./redux-thunk-ClJT1hhx.js";import"./axios-9PTFF6AP.js";import"./rc-util-DVEPga9-.js";import"./@babel-Bssi87AP.js";import"./@emotion-CW87jbl0.js";import"./stylis-D5iaQeiq.js";import"./resize-observer-polyfill-B1PUzC5B.js";import"./rc-resize-observer-OqVzQPEu.js";import"./rc-motion-C3tnhy2U.js";import"./@rc-component-B7glsBvU.js";import"./rc-notification-BU1JQ1oB.js";import"./rc-overflow-BHdZLj7t.js";import"./rc-picker-UBE7xiBA.js";import"./dayjs-Cjk_ngT2.js";import"./rc-tabs-CxzWAOyN.js";import"./rc-dropdown-BO-tmEXF.js";import"./rc-menu-CN7ruIKX.js";import"./rc-select-C2-AJ45Z.js";import"./rc-virtual-list-2uybl3mp.js";import"./rc-field-form-RBvcZ110.js";import"./scroll-into-view-if-needed-DRvhZyyj.js";import"./compute-scroll-into-view-J484ERGr.js";import"./rc-dialog-DjLbSgI8.js";import"./rc-switch-gTEUW9ud.js";import"./rc-table-mlfxtKPe.js";import"./rc-tree-XLUh9fGJ.js";import"./rc-checkbox-DSSeAk8Y.js";import"./rc-pagination-BIRv3rAM.js";import"./throttle-debounce-CUWDS_la.js";import"./rc-input-BMc9GUi3.js";import"./rc-tooltip-Cl3xOnqL.js";import"./rc-textarea-GKK6NUoL.js";import"./copy-to-clipboard-iuHVwNMD.js";import"./toggle-selection-BHUZwh74.js";const _=i=>({keyword:i.keyword||null,status:i.status||null,role_id:i.role_id||null,page:i.page||1,per_page:i.per_page||10}),We=()=>{const i=A(),g=L(),{data:p}=B(e=>e.storeRole),[l,v]=F(),[r,f]=n.useState(()=>({keyword:l.get("keyword")||null,status:l.get("status")||null,role_id:l.get("role_id")||null,page:parseInt(l.get("page")||"1",10),per_page:parseInt(l.get("per_page")||"10",10)})),y=z(r,500),[R,c]=n.useState(!1),[j,b]=n.useState({meta:{total:0,page:1,per_page:10},data:[]}),T=n.useMemo(()=>p.map(e=>({label:e.name,value:String(e.id)})),[p]);n.useEffect(()=>{p.length||i($(O))},[i,p.length]),n.useEffect(()=>{const e={...r};Object.entries(e).forEach(([a,o])=>{o===null||o===""?l.delete(a):l.set(a,String(o))}),v(l)},[r]),n.useEffect(()=>{k(_(y))},[y]);const k=async e=>{var a,o;c(!0);try{const s=await I.gets(e);b(s.data)}catch(s){x((a=s==null?void 0:s.meta)==null?void 0:a.message,(o=s==null?void 0:s.meta)==null?void 0:o.code)}finally{c(!1)}},E=async e=>{var a,o;try{if(!await K())return;c(!0);const P=await I.destroy(e),{meta:w}=P.data;x(w.message,w.code),await k(_(r))}catch(s){x((a=s==null?void 0:s.meta)==null?void 0:a.message,(o=s==null?void 0:s.meta)==null?void 0:o.code)}finally{c(!1)}},h=(e,a)=>{a===void 0&&(a=null),f(o=>({...o,[e]:a,page:1}))},D=[{title:"ID",dataIndex:"id",key:"id"},{title:"Name",dataIndex:"name",key:"name"},{title:"Email",dataIndex:"email",key:"email"},{title:"Roles",dataIndex:"roles",key:"roles",render:e=>e.map(a=>a.name).join(", ")||"-"},{title:"Status",dataIndex:"status",key:"status",render:e=>t.jsx(Y,{color:e?"green":"red",children:e?"Active":"Block"})},{title:"Actions",key:"actions",align:"center",width:120,render:(e,a)=>t.jsxs("div",{children:[t.jsx(u,{type:"link",icon:t.jsx(G,{}),onClick:()=>g(`/users/${a.id}/view`)}),t.jsx(u,{type:"link",icon:t.jsx(H,{}),onClick:()=>g(`/users/${a.id}/edit`)}),t.jsx(u,{type:"link",danger:!0,icon:t.jsx(J,{}),onClick:()=>E(a.id)})]})}];return t.jsxs(M,{children:[t.jsxs(S,{children:[t.jsx(m,{span:12,children:t.jsx(d.Title,{level:4,children:"Users"})}),t.jsx(m,{span:2,offset:10,style:{marginTop:30},children:N("create","users")?t.jsx(u,{type:"primary",icon:t.jsx(q,{}),onClick:()=>g("/users/create"),block:!0,children:"Create"}):""})]}),t.jsxs(S,{gutter:[16,16],style:{marginBottom:16},children:[t.jsxs(m,{xs:24,sm:12,md:3,children:[t.jsx(d.Title,{level:5,children:"Keyword"}),t.jsx(U,{placeholder:"ID, Email, Name...",value:r.keyword||"",onChange:e=>h("keyword",e.target.value),allowClear:!0})]}),t.jsxs(m,{xs:24,sm:12,md:3,children:[t.jsx(d.Title,{level:5,children:"Status"}),t.jsx(C,{placeholder:"Select status",value:r.status,onChange:e=>h("status",e),allowClear:!0,style:{width:"100%"},options:[{label:"Active",value:"1"},{label:"Block",value:"0"}]})]}),t.jsxs(m,{xs:24,sm:12,md:3,children:[t.jsx(d.Title,{level:5,children:"Role"}),t.jsx(C,{placeholder:"Select role",value:r.role_id,onChange:e=>h("role_id",e),allowClear:!0,style:{width:"100%"},options:T})]})]}),t.jsx(Q,{size:"small",columns:D,dataSource:j.data,rowKey:"id",loading:R,pagination:{current:r.page,pageSize:r.per_page,total:j.meta.total,onChange:(e,a)=>f(o=>({...o,page:e,per_page:a}))}})]})};export{We as default};
